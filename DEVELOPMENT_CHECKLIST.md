# 开发工作流检查清单

## 🎯 每次开发前必读

### 1. 阅读开发规范
- [ ] 阅读 `DEVELOPMENT_STANDARDS.md`
- [ ] 了解API命名规范
- [ ] 确认文件组织规范
- [ ] 理解质量检查要求

### 2. 分析现有代码
- [ ] 搜索相关API端点：`grep -r "相关关键词" .`
- [ ] 检查现有实现：查看相关路由文件
- [ ] 确认数据库结构：检查相关表结构
- [ ] 了解前端调用：查看组件中的API调用

## 🔧 开发过程中

### 3. 后端开发
- [ ] 使用统一的API端点命名
- [ ] 实现完整的参数验证
- [ ] 添加适当的错误处理
- [ ] 使用数据库事务
- [ ] 添加日志记录
- [ ] 更新路由文件

### 4. 前端开发
- [ ] 使用与后端一致的API端点
- [ ] 实现适当的加载状态
- [ ] 添加错误处理
- [ ] 更新组件状态管理
- [ ] 确保用户体验流畅

### 5. 数据库操作
- [ ] 使用事务包装写操作
- [ ] 添加适当的索引
- [ ] 验证数据完整性
- [ ] 更新相关表结构
- [ ] 记录数据库变更

## ✅ 开发完成后

### 6. 一致性检查
- [ ] 运行API一致性检查：`node scripts/api-consistency-check.js`
- [ ] 验证前后端API端点匹配
- [ ] 检查文档同步性
- [ ] 确认测试用例更新

### 7. 功能测试
- [ ] 测试正常流程
- [ ] 测试错误处理
- [ ] 验证数据库操作
- [ ] 检查用户界面
- [ ] 确认性能表现

### 8. 文档更新
- [ ] 更新API文档
- [ ] 记录变更日志
- [ ] 更新使用示例
- [ ] 添加错误处理说明

## 🚨 常见问题预防

### API端点不一致
**检查命令**：
```bash
# 搜索所有API端点
grep -r "buy-with-karma\|unlock-with-karma" .
grep -r "chapter-unlock" .
```

**预防措施**：
- 修改前先搜索所有相关文件
- 使用统一的命名规范
- 运行一致性检查脚本

### 数据库事务遗漏
**检查要点**：
- 所有写操作是否使用事务
- 是否有适当的回滚机制
- 错误处理是否完整

### 前端状态管理错误
**检查要点**：
- 状态更新是否及时
- 错误状态是否正确处理
- 加载状态是否适当

## 📋 快速检查命令

### 搜索API端点
```bash
# 搜索特定端点
grep -r "unlock-with-karma" .
grep -r "buy-with-karma" .

# 搜索所有API调用
grep -r "fetch.*api" frontend/src/
grep -r "router\." backend/routes/
```

### 检查文件一致性
```bash
# 检查相关文件是否同步更新
ls -la *karma*
ls -la *unlock*
ls -la *chapter*
```

### 运行自动化检查
```bash
# 运行API一致性检查
node scripts/api-consistency-check.js

# 检查代码质量
npm run lint
npm run test
```

## 🎯 质量保证

### 代码质量
- [ ] 代码格式规范
- [ ] 变量命名清晰
- [ ] 函数职责单一
- [ ] 错误处理完整
- [ ] 日志记录适当

### API质量
- [ ] 端点命名一致
- [ ] 参数验证完整
- [ ] 响应格式标准
- [ ] 错误信息清晰
- [ ] 性能优化合理

### 文档质量
- [ ] API文档完整
- [ ] 使用示例清晰
- [ ] 错误处理说明
- [ ] 变更记录详细

---

**重要提醒**：每次开发前请仔细阅读本清单，确保所有步骤都已完成。如有疑问，请及时沟通确认。
