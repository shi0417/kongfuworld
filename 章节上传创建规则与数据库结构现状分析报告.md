# ç« èŠ‚ä¸Šä¼ /åˆ›å»ºè§„åˆ™ & ç›¸å…³æ•°æ®åº“ç»“æ„ç°çŠ¶åˆ†ææŠ¥å‘Š

> **åˆ†æç›®æ ‡**ï¼šä¸ºåç»­å®ç°"AI æ‰¹é‡ç¿»è¯‘å¯¼å…¥åŠŸèƒ½"åšå‡†å¤‡  
> **åˆ†ææ—¶é—´**ï¼š2025-12-07  
> **åˆ†æèŒƒå›´**ï¼šå‰ç«¯åå°å¯¼èˆªã€åç«¯ç« èŠ‚åˆ›å»º/æ›´æ–°æ¥å£ã€æ•°æ®åº“è¡¨ç»“æ„

---

## ä¸€ã€å‰ç«¯ï¼ˆAdminPanel åå°ï¼‰ç›¸å…³åˆ†æ

### 1.1 AdminPanel å·¦ä¾§å¯¼èˆªç»“æ„

**æ–‡ä»¶è·¯å¾„**ï¼š`frontend/src/pages/AdminPanel.tsx`

**å¯¼èˆªé…ç½®ä½ç½®**ï¼š`frontend/src/pages/adminMenuConfig.ts`

#### å¯¼èˆªç»“æ„è¯´æ˜

AdminPanel çš„å·¦ä¾§å¯¼èˆªåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š

1. **é¡¶éƒ¨ç‹¬ç«‹èœå•**ï¼ˆ`topStandaloneMenus`ï¼‰ï¼š
   - `novel-review` - å°è¯´å®¡æ‰¹
   - `new-novel-pool` - æ–°å°è¯´æ± 
   - `chapter-approval` - ç« èŠ‚å®¡æ‰¹

2. **æ”¶ç›Šä¸ç¼–è¾‘ç®¡ç†åˆ†ç»„**ï¼ˆ`incomeEditorMenuGroup`ï¼‰ï¼š
   - `payment-stats` - è´¹ç”¨ç»Ÿè®¡
   - `author-income` - ä½œè€…æ”¶å…¥ç»Ÿè®¡
   - `reader-income` - è¯»è€…æ”¶å…¥ç»Ÿè®¡
   - `settlement-overview` - ç»“ç®—æ€»è§ˆ
   - `base-income` - åŸºç¡€æ”¶å…¥ç»Ÿè®¡-1
   - `author-royalty` - ä½œè€…åŸºç¡€æ”¶å…¥è¡¨-2
   - `commission-transaction` - æ¨å¹¿ä½£é‡‘æ˜ç»†-3
   - `editor-base-income` - ç¼–è¾‘åŸºç¡€æ”¶å…¥-4
   - `commission-settings` - ææˆè®¾ç½®
   - **`editor-management` - ç¼–è¾‘ç®¡ç†** â­ï¼ˆå»ºè®®åœ¨æ­¤å¤„æ–°å¢"AI æ‰¹é‡ç¿»è¯‘å¯¼å…¥"å…¥å£ï¼‰

3. **åº•éƒ¨ç‹¬ç«‹èœå•**ï¼ˆ`bottomStandaloneMenus`ï¼‰ï¼š
   - `admin-payout-account` - æˆ‘çš„æ”¶æ¬¾è´¦æˆ·

#### å¯¼èˆªå®ç°æœºåˆ¶

- **é…ç½®æ–¹å¼**ï¼šé€šè¿‡ `adminMenuConfig.ts` æ–‡ä»¶å®šä¹‰èœå•é¡¹
- **Tab åˆ‡æ¢**ï¼šæ¯ä¸ªèœå•é¡¹é€šè¿‡ `tab` å­—æ®µå¯¹åº” `AdminPanel` ç»„ä»¶ä¸­çš„ `activeTab` çŠ¶æ€
- **æƒé™æ§åˆ¶**ï¼šé€šè¿‡ `hasMenuPermission()` å‡½æ•°æ£€æŸ¥ç®¡ç†å‘˜æƒé™
- **åˆ†ç»„å±•å¼€/æŠ˜å **ï¼š`incomeEditorMenuGroup` æ”¯æŒå±•å¼€/æŠ˜å ï¼ŒçŠ¶æ€ç”± `incomeAndEditorMenuExpanded` æ§åˆ¶

**å»ºè®®**ï¼šåœ¨ `incomeEditorMenuGroup.items` æ•°ç»„ä¸­ï¼Œåœ¨ `editor-management` ä¹‹åæ–°å¢ä¸€ä¸ªèœå•é¡¹ï¼Œä¾‹å¦‚ï¼š
```typescript
{ key: 'ai-batch-translation', label: 'AI æ‰¹é‡ç¿»è¯‘å¯¼å…¥', icon: 'ğŸ¤–', tab: 'ai-batch-translation' }
```

### 1.2 å½“å‰æ˜¯å¦å·²æœ‰ç« èŠ‚ç®¡ç†/å¯¼å…¥é¡µé¢

**æœç´¢ç»“æœ**ï¼š

1. **ç« èŠ‚å®¡æ‰¹é¡µé¢**ï¼ˆå·²å­˜åœ¨ï¼‰ï¼š
   - **è·¯å¾„**ï¼š`frontend/src/pages/AdminPanel/ChapterApproval/`
   - **ç»„ä»¶**ï¼š
     - `index.tsx` - ç« èŠ‚å®¡æ‰¹ä¸»é¡µé¢
     - `ChapterList.tsx` - ç« èŠ‚åˆ—è¡¨ç»„ä»¶
     - `ChapterDetail.tsx` - ç« èŠ‚è¯¦æƒ…ç»„ä»¶
   - **åŠŸèƒ½**ï¼šç”¨äºç®¡ç†å‘˜å®¡æ ¸ç« èŠ‚ï¼Œæ”¯æŒæ‰¹é‡å®¡æ ¸
   - **Tab æ ‡è¯†**ï¼š`chapter-approval`

2. **ç« èŠ‚ç®¡ç† Tab**ï¼ˆä½œè€…ç«¯ï¼‰ï¼š
   - **è·¯å¾„**ï¼š`frontend/src/pages/NovelManage/ChapterManageTab.tsx`
   - **åŠŸèƒ½**ï¼šä½œè€…ç®¡ç†è‡ªå·±å°è¯´çš„ç« èŠ‚ï¼ŒåŒ…æ‹¬ï¼š
     - ç« èŠ‚åˆ—è¡¨å±•ç¤ºï¼ˆæ”¯æŒç­›é€‰ã€æœç´¢ã€æ’åºï¼‰
     - æ‰¹é‡æ“ä½œï¼ˆæ‰¹é‡è®¾ç½®å·ã€æ‰¹é‡è®¾ç½®èŒƒå›´ï¼‰
     - ç« èŠ‚çŠ¶æ€ç®¡ç†ï¼ˆå·²å‘å¸ƒã€å®šæ—¶å‘å¸ƒã€æœªå‘å¸ƒã€å¾…å®¡æ ¸ç­‰ï¼‰
   - **è®¿é—®è·¯å¾„**ï¼š`/novel-manage/:novelId?tab=chapters`

3. **ç« èŠ‚ç¼–å†™é¡µé¢**ï¼ˆä½œè€…ç«¯ï¼‰ï¼š
   - **è·¯å¾„**ï¼š`frontend/src/pages/ChapterWriter.tsx`
   - **åŠŸèƒ½**ï¼šå•ä¸ªç« èŠ‚çš„åˆ›å»º/ç¼–è¾‘ç•Œé¢
   - **è®¿é—®è·¯å¾„**ï¼š`/chapter-writer?novelId=xxx&chapterId=xxx`

**ç»“è®º**ï¼š
- âœ… å·²æœ‰ç« èŠ‚å®¡æ‰¹é¡µé¢ï¼ˆç®¡ç†å‘˜ç«¯ï¼‰
- âœ… å·²æœ‰ç« èŠ‚ç®¡ç†é¡µé¢ï¼ˆä½œè€…ç«¯ï¼‰
- âŒ **ç›®å‰æ²¡æœ‰æ‰¹é‡å¯¼å…¥ç« èŠ‚çš„åŠŸèƒ½é¡µé¢**
- âŒ **ç›®å‰æ²¡æœ‰ç¿»è¯‘ç›¸å…³çš„åŠŸèƒ½é¡µé¢**

---

## äºŒã€åç«¯ç« èŠ‚åˆ›å»º/æ›´æ–°æ¥å£åˆ†æï¼ˆé‡ç‚¹ï¼‰

### 2.1 æ¥å£åˆ—è¡¨ï¼ˆURL/æ–¹æ³•/æ–‡ä»¶è·¯å¾„ï¼‰

#### 2.1.1 åˆ›å»ºç« èŠ‚æ¥å£

**æ¥å£ä¿¡æ¯**ï¼š
- **URL**ï¼š`POST /api/chapter/create`
- **æ–‡ä»¶è·¯å¾„**ï¼š`backend/routes/novelCreation.js`
- **å‡½æ•°ä½ç½®**ï¼šç¬¬ 1127 è¡Œ
- **è·¯ç”±æ³¨å†Œ**ï¼šé€šè¿‡ `app.use('/api', novelCreationRoutes)` æ³¨å†Œ

#### 2.1.2 æ›´æ–°ç« èŠ‚æ¥å£

**æ¥å£ä¿¡æ¯**ï¼š
- **URL**ï¼š`POST /api/chapter/update`
- **æ–‡ä»¶è·¯å¾„**ï¼š`backend/routes/novelCreation.js`
- **å‡½æ•°ä½ç½®**ï¼šç¬¬ 1538 è¡Œ

#### 2.1.3 æ‰¹é‡æ›´æ–°è§£é”ä»·æ ¼æ¥å£

**æ¥å£ä¿¡æ¯**ï¼š
- **URL**ï¼š`POST /api/chapters/batch-update-unlock-price`
- **æ–‡ä»¶è·¯å¾„**ï¼š`backend/routes/novelCreation.js`
- **å‡½æ•°ä½ç½®**ï¼šç¬¬ 2088 è¡Œ
- **åŠŸèƒ½**ï¼šæ‰¹é‡æ›´æ–°ç« èŠ‚çš„ `unlock_price`ï¼ˆæŒ‰å­—æ•°è®¡ä»·ï¼‰

#### 2.1.4 æ‰¹é‡ä¸Šä¼ ç« èŠ‚æ¥å£ï¼ˆä¸Šä¼ å°è¯´åŠŸèƒ½ï¼‰

**æ¥å£ä¿¡æ¯**ï¼š
- **URL**ï¼š`POST /api/upload-novel`ï¼ˆæ¨æµ‹ï¼Œéœ€ç¡®è®¤ï¼‰
- **æ–‡ä»¶è·¯å¾„**ï¼š`backend/upload_novel.js`
- **å‡½æ•°ä½ç½®**ï¼š`uploadNovelAPI` å‡½æ•°ï¼ˆç¬¬ 1144 è¡Œï¼‰
- **åŠŸèƒ½**ï¼šæ”¯æŒæ‰¹é‡ä¸Šä¼ ç« èŠ‚ï¼ˆé€šè¿‡è§£ææ–‡ä»¶ï¼Œå¦‚ txtã€word ç­‰ï¼‰

### 2.2 è¯·æ±‚å‚æ•°ä¸æ ¡éªŒè§„åˆ™

#### 2.2.1 åˆ›å»ºç« èŠ‚æ¥å£ï¼ˆ`POST /api/chapter/create`ï¼‰

**è¯·æ±‚ä½“å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| `novel_id` | number | âœ… | - | å°è¯´ID |
| `chapter_number` | number | âœ… | - | ç« èŠ‚å· |
| `title` | string | âœ… | - | ç« èŠ‚æ ‡é¢˜ï¼ˆä¸èƒ½ä¸ºç©ºå­—ç¬¦ä¸²ï¼‰ |
| `content` | string | âŒ | `''` | ç« èŠ‚æ­£æ–‡ |
| `translator_note` | string | âŒ | `''` | è¯‘è€…æ³¨ |
| `is_visible` | string | âŒ | `'0'` | æ˜¯å¦å¯è§ |
| `is_draft` | string | âŒ | `'1'` | æ˜¯å¦è‰ç¨¿ï¼ˆ'1'=è‰ç¨¿ï¼Œ'0'=å‘å¸ƒï¼‰ |
| `word_count` | number | âŒ | è‡ªåŠ¨è®¡ç®— | å­—æ•°ï¼ˆå»é™¤ç©ºæ ¼åçš„å­—ç¬¦æ•°ï¼‰ |
| `release_date` | datetime | âŒ | `null` | å®šæ—¶å‘å¸ƒæ—¶é—´ |
| `is_released` | string | âŒ | `'1'` | æ˜¯å¦å·²å‘å¸ƒ |

**æ ¡éªŒè§„åˆ™**ï¼š

1. **å¿…å¡«å­—æ®µæ ¡éªŒ**ï¼š
   - `novel_id`ï¼šå¿…é¡»æä¾›ä¸”ä¸ºæœ‰æ•ˆæ•°å­—
   - `chapter_number`ï¼šå¿…é¡»æä¾›ä¸”ä¸ºæœ‰æ•ˆæ•°å­—
   - `title`ï¼šå¿…é¡»æä¾›ä¸”å»é™¤ç©ºæ ¼åä¸ä¸ºç©º

2. **ç« èŠ‚å·å”¯ä¸€æ€§æ ¡éªŒ**ï¼š
   - åœ¨åˆ›å»ºç« èŠ‚å‰ï¼Œä¼šæ£€æŸ¥ `chapter` è¡¨ä¸­æ˜¯å¦å­˜åœ¨ç›¸åŒ `novel_id` å’Œ `chapter_number` çš„è®°å½•
   - å¦‚æœå­˜åœ¨ï¼Œè¿”å› HTTP 409 é”™è¯¯ï¼Œé”™è¯¯ç  `CHAPTER_EXISTS`ï¼Œå¹¶è¿”å›å·²å­˜åœ¨ç« èŠ‚çš„ä¿¡æ¯

3. **å­—æ•°è®¡ç®—**ï¼š
   - å¦‚æœæœªæä¾› `word_count`ï¼Œè‡ªåŠ¨è®¡ç®—ï¼š`content.replace(/\s/g, '').length`
   - å»é™¤æ‰€æœ‰ç©ºæ ¼åè®¡ç®—å­—ç¬¦æ•°

4. **çŠ¶æ€é€»è¾‘**ï¼š
   - å¦‚æœ `is_draft === '1'`ï¼š
     - `review_status = 'draft'`
     - `is_released = 0`
   - å¦‚æœ `is_draft !== '1'`ï¼ˆå‘å¸ƒç« èŠ‚ï¼‰ï¼š
     - `review_status = 'submitted'`ï¼ˆè¿›å…¥å®¡æ ¸æµç¨‹ï¼‰
     - å¦‚æœæœ‰ `release_date`ï¼š`is_released = 0`ï¼ˆå®šæ—¶å‘å¸ƒï¼‰
     - å¦‚æœæ²¡æœ‰ `release_date`ï¼š`is_released = 1`ï¼ˆç«‹å³å‘å¸ƒï¼‰ï¼Œ`release_date` è®¾ç½®ä¸ºå½“å‰æ—¶é—´ï¼ˆæœ¬åœ°æ—¶é—´ï¼‰

#### 2.2.2 æ›´æ–°ç« èŠ‚æ¥å£ï¼ˆ`POST /api/chapter/update`ï¼‰

**è¯·æ±‚ä½“å­—æ®µ**ï¼š

| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| `chapter_id` | number | âœ… | ç« èŠ‚ID |
| `novel_id` | number | âŒ | å°è¯´ID |
| `chapter_number` | number | âŒ | ç« èŠ‚å· |
| `title` | string | âœ… | ç« èŠ‚æ ‡é¢˜ |
| `content` | string | âŒ | ç« èŠ‚æ­£æ–‡ |
| `translator_note` | string | âŒ | è¯‘è€…æ³¨ |
| `is_visible` | string | âŒ | æ˜¯å¦å¯è§ |
| `is_draft` | string | âŒ | æ˜¯å¦è‰ç¨¿ |
| `word_count` | number | âŒ | å­—æ•° |
| `release_date` | datetime | âŒ | å®šæ—¶å‘å¸ƒæ—¶é—´ |
| `is_released` | string | âŒ | æ˜¯å¦å·²å‘å¸ƒ |
| `action` | string | âŒ | æ“ä½œç±»å‹ï¼š'draft', 'publish', 'schedule' |

**æ ¡éªŒè§„åˆ™**ï¼š

1. **å¿…å¡«å­—æ®µ**ï¼š
   - `chapter_id`ï¼šå¿…é¡»æä¾›
   - `title`ï¼šå¿…é¡»æä¾›ä¸”å»é™¤ç©ºæ ¼åä¸ä¸ºç©º

2. **çŠ¶æ€å˜æ›´é€»è¾‘**ï¼š
   - æ›´æ–°å‰ä¼šæŸ¥è¯¢æ—§ç« èŠ‚çŠ¶æ€
   - æ ¹æ® `action` å‚æ•°å’Œ `is_draft`ã€`release_date` ç­‰å­—æ®µå†³å®šæ–°çš„ `review_status` å’Œ `is_released`

### 2.3 ç« èŠ‚åˆ›å»ºæ—¶çš„ä¸šåŠ¡è”åŠ¨ï¼ˆç»Ÿè®¡ã€æ”¶ç›Šã€çŠ¶æ€ï¼‰

#### 2.3.1 è‡ªåŠ¨è®¡ç®—è§£é”ä»·æ ¼ï¼ˆ`unlock_price`ï¼‰

**é€»è¾‘ä½ç½®**ï¼š`backend/routes/novelCreation.js` ç¬¬ 1259-1380 è¡Œ

**è®¡ç®—æµç¨‹**ï¼š

1. **æŸ¥è¯¢æˆ–åˆ›å»º `unlockprice` é…ç½®**ï¼š
   - æŸ¥è¯¢ `unlockprice` è¡¨ï¼Œè·å– `karma_per_1000`ã€`min_karma`ã€`max_karma`ã€`default_free_chapters`
   - å¦‚æœä¸å­˜åœ¨ï¼Œåˆ›å»ºé»˜è®¤é…ç½®ï¼š`karma_per_1000=6, min_karma=5, max_karma=30, default_free_chapters=50`

2. **åˆ¤æ–­å…è´¹/æ”¶è´¹ç« èŠ‚**ï¼š
   - å¦‚æœ `chapter_number <= default_free_chapters`ï¼šå…è´¹ç« èŠ‚
     - `is_advance = 0`
     - `key_cost = 0`
     - `unlock_price = 0`
   - å¦‚æœ `chapter_number > default_free_chapters`ï¼šæ”¶è´¹ç« èŠ‚
     - `key_cost = 1`
     - è°ƒç”¨ `calculateChapterPrice()` è®¡ç®— `unlock_price`ï¼ˆæŒ‰å­—æ•°è®¡ä»·ï¼‰

3. **é¢„è¯»ç« èŠ‚é€»è¾‘**ï¼ˆä»…æ”¶è´¹ç« èŠ‚ï¼‰ï¼š
   - æŸ¥è¯¢ `novel.champion_status`
   - å¦‚æœ `champion_status === 'approved'`ï¼š
     - æŸ¥è¯¢ `novel_champion_tiers` è¡¨ï¼Œè·å–æœ€å¤§ `tier_level` å¯¹åº”çš„ `advance_chapters`ï¼ˆè®¾ä¸º Aï¼‰
     - æŸ¥è¯¢å½“å‰å°è¯´ `is_advance=1` çš„ç« èŠ‚æ•°é‡ï¼ˆè®¾ä¸º Bï¼‰
     - å¦‚æœ `A > B`ï¼šæ–°ç« èŠ‚ `is_advance = 1`
     - å¦‚æœ `A = B`ï¼šæ–°ç« èŠ‚ `is_advance = 1`ï¼ŒåŒæ—¶å°†å€’æ•°ç¬¬ `A+1` æ¡ `is_advance=1` çš„ç« èŠ‚è®¾ä¸º `is_advance=0`
     - å¦‚æœ `A < B`ï¼šæ–°ç« èŠ‚ `is_advance = 0`

#### 2.3.2 å®šæ—¶å‘å¸ƒè®°å½•

**é€»è¾‘ä½ç½®**ï¼š`backend/routes/novelCreation.js` ç¬¬ 1486-1498 è¡Œ

**æµç¨‹**ï¼š
- å¦‚æœ `release_date` å­˜åœ¨ä¸” `is_released === 0`ï¼Œæ’å…¥ `scheduledrelease` è¡¨
- å­—æ®µï¼š`novel_id`, `chapter_id`, `release_time`, `is_released=0`

#### 2.3.3 ä½œè€…å­—æ•°ç»Ÿè®¡

**é€»è¾‘ä½ç½®**ï¼š`backend/routes/novelCreation.js` ç¬¬ 1500-1522 è¡Œ

**Service**ï¼š`backend/services/authorDailyWordCountService.js`

**æµç¨‹**ï¼š
- å¦‚æœ `is_released === 1` ä¸” `release_date` ä¸ä¸ºç©ºï¼š
  - è°ƒç”¨ `authorDailyWordCountService.recordChapterReleaseChange()`
  - è®°å½•åˆ° `author_daily_word_count` è¡¨
  - å­—æ®µï¼š`author_id`, `novel_id`, `chapter_id`, `word_count_before`, `word_count_after`, `word_delta`, `date`

**è¡¨ç»“æ„**ï¼ˆ`author_daily_word_count`ï¼‰ï¼š
```sql
CREATE TABLE `author_daily_word_count` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `author_id` INT NOT NULL COMMENT 'user.idï¼Œä½œè€…',
  `novel_id` INT NOT NULL COMMENT 'novel.idï¼Œä½œå“',
  `chapter_id` INT NOT NULL COMMENT 'chapter.idï¼Œç« èŠ‚',
  `date` DATE NOT NULL COMMENT 'è‡ªç„¶æ—¥ï¼ˆæŒ‰å‘å¸ƒæ—¥æœŸï¼‰',
  `word_count_before` INT NOT NULL DEFAULT 0,
  `word_count_after` INT NOT NULL DEFAULT 0,
  `word_delta` INT NOT NULL DEFAULT 0,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_author_date` (`author_id`, `date`),
  KEY `idx_author_novel_date` (`author_id`, `novel_id`, `date`),
  KEY `idx_chapter` (`chapter_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

#### 2.3.4 æ‰¹é‡ä¸Šä¼ ç« èŠ‚é€»è¾‘ï¼ˆ`upload_novel.js`ï¼‰

**å‡½æ•°ä½ç½®**ï¼š`backend/upload_novel.js` ç¬¬ 663-708 è¡Œ

**å‡½æ•°å**ï¼š`uploadChapters(novelId, volumeId, chapters, novelConfig, startChapterNumber = 1)`

**å‚æ•°**ï¼š
- `novelId`ï¼šå°è¯´ID
- `volumeId`ï¼šå·ID
- `chapters`ï¼šç« èŠ‚æ•°ç»„ï¼Œæ¯ä¸ªç« èŠ‚åŒ…å«ï¼š
  - `chapterNumber`ï¼šç« èŠ‚å·
  - `title`ï¼šæ ‡é¢˜
  - `content`ï¼šæ­£æ–‡
  - `isLocked`ï¼šæ˜¯å¦é”å®š
  - `isVipOnly`ï¼šæ˜¯å¦VIPä¸“äº«
  - `isAdvance`ï¼šæ˜¯å¦é¢„è¯»
  - `isVisible`ï¼šæ˜¯å¦å¯è§
  - `unlockCost`ï¼šè§£é”æˆæœ¬
  - `translatorNote`ï¼šè¯‘è€…æ³¨
  - `volumeId`ï¼šå·ID
- `novelConfig`ï¼šå°è¯´é…ç½®ï¼ˆåŒ…å« `freeChapters`ã€`minCost`ã€`maxCost` ç­‰ï¼‰
- `startChapterNumber`ï¼šèµ·å§‹ç« èŠ‚å·ï¼ˆé»˜è®¤ 1ï¼‰

**å®ç°æ–¹å¼**ï¼š
- ä½¿ç”¨ `INSERT INTO chapter (...) VALUES ?` æ‰¹é‡æ’å…¥
- æ‰¹é‡æ’å…¥å­—æ®µï¼š`novel_id`, `volume_id`, `chapter_number`, `title`, `content`, `is_locked`, `is_vip_only`, `is_advance`, `is_visible`, `unlock_price`, `translator_note`, `prev_chapter_id`

**æ³¨æ„**ï¼šæ­¤å‡½æ•°**ä¸åŒ…å«**ä»¥ä¸‹é€»è¾‘ï¼š
- âŒ ä¸æ£€æŸ¥ç« èŠ‚å·å”¯ä¸€æ€§
- âŒ ä¸è®¾ç½® `review_status`ï¼ˆå¯èƒ½é»˜è®¤ä¸ºæ•°æ®åº“é»˜è®¤å€¼ï¼‰
- âŒ ä¸è®¾ç½® `is_released`ï¼ˆå¯èƒ½é»˜è®¤ä¸ºæ•°æ®åº“é»˜è®¤å€¼ï¼‰
- âŒ ä¸è®°å½•å­—æ•°ç»Ÿè®¡
- âŒ ä¸è®¡ç®—è§£é”ä»·æ ¼ï¼ˆä½¿ç”¨ä¼ å…¥çš„ `unlockCost`ï¼‰

---

## ä¸‰ã€æ•°æ®åº“è¡¨ç»“æ„

### 3.1 `chapter` è¡¨ç»“æ„åŠè¯´æ˜

**å®Œæ•´ CREATE TABLE è¯­å¥**ï¼š

```sql
CREATE TABLE `chapter` (
  `id` int NOT NULL AUTO_INCREMENT,
  `novel_id` int NOT NULL,
  `volume_id` int NOT NULL,
  `chapter_number` int NOT NULL,
  `title` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `content` text COLLATE utf8mb4_unicode_ci,
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `translator_note` text COLLATE utf8mb4_unicode_ci,
  `is_advance` tinyint(1) DEFAULT '0' COMMENT 'æ˜¯å¦ä¸ºé¢„è¯»ç« èŠ‚ï¼ˆ0=å¦ï¼Œ1=é¢„è¯»ï¼‰',
  `unlock_price` int DEFAULT '0' COMMENT 'è§£é”æ‰€éœ€é’¥åŒ™æ•°é‡ï¼ˆ0è¡¨ç¤ºå…è´¹ï¼‰',
  `review_status` enum('submitted','reviewing','approved','rejected','draft') DEFAULT 'submitted' COMMENT 'å®¡æ ¸çŠ¶æ€',
  `is_released` tinyint(1) DEFAULT '1' COMMENT 'æ˜¯å¦å·²å‘å¸ƒï¼ˆ0=æœªå‘å¸ƒï¼Œ1=å·²å‘å¸ƒï¼‰',
  `release_date` datetime DEFAULT NULL COMMENT 'å‘å¸ƒæ—¥æœŸ',
  `word_count` int DEFAULT NULL COMMENT 'å­—æ•°',
  `key_cost` int DEFAULT NULL COMMENT 'é’¥åŒ™æˆæœ¬',
  `unlock_priority` varchar(50) DEFAULT NULL COMMENT 'è§£é”ä¼˜å…ˆçº§',
  `editor_admin_id` int DEFAULT NULL COMMENT 'ç¼–è¾‘ç®¡ç†å‘˜ID',
  `chief_editor_admin_id` int DEFAULT NULL COMMENT 'ä¸»ç¼–ç®¡ç†å‘˜ID',
  PRIMARY KEY (`id`),
  KEY `novel_id` (`novel_id`),
  KEY `volume_id` (`volume_id`),
  CONSTRAINT `chapter_ibfk_1` FOREIGN KEY (`novel_id`) REFERENCES `novel` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

**ä¸»è¦å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å¤‡æ³¨ |
|--------|------|------|------|
| `id` | int | ä¸»é”®ï¼Œè‡ªå¢ | - |
| `novel_id` | int | å°è¯´ID | å¤–é”®å…³è” `novel.id` |
| `volume_id` | int | å·ID | å¤–é”®å…³è” `volume.id` |
| `chapter_number` | int | ç« èŠ‚å· | **åŒä¸€å°è¯´å†…åº”å”¯ä¸€** |
| `title` | varchar(255) | ç« èŠ‚æ ‡é¢˜ | å¿…å¡« |
| `content` | text | ç« èŠ‚æ­£æ–‡ | å¯ç©º |
| `translator_note` | text | è¯‘è€…æ³¨ | å¯ç©º |
| `is_advance` | tinyint(1) | æ˜¯å¦ä¸ºé¢„è¯»ç« èŠ‚ | 0=å¦ï¼Œ1=æ˜¯ |
| `unlock_price` | int | è§£é”ä»·æ ¼ï¼ˆKarmaï¼‰ | 0=å…è´¹ |
| `review_status` | enum | å®¡æ ¸çŠ¶æ€ | 'submitted','reviewing','approved','rejected','draft' |
| `is_released` | tinyint(1) | æ˜¯å¦å·²å‘å¸ƒ | 0=æœªå‘å¸ƒï¼Œ1=å·²å‘å¸ƒ |
| `release_date` | datetime | å‘å¸ƒæ—¥æœŸ | å¯ç©º |
| `word_count` | int | å­—æ•° | å¯ç©ºï¼Œé€šå¸¸è‡ªåŠ¨è®¡ç®— |
| `key_cost` | int | é’¥åŒ™æˆæœ¬ | å¯ç©º |
| `unlock_priority` | varchar(50) | è§£é”ä¼˜å…ˆçº§ | å¯ç©º |
| `editor_admin_id` | int | ç¼–è¾‘ç®¡ç†å‘˜ID | å¯ç©º |
| `chief_editor_admin_id` | int | ä¸»ç¼–ç®¡ç†å‘˜ID | å¯ç©º |

**ç´¢å¼•ä¿¡æ¯**ï¼š
- **ä¸»é”®**ï¼š`PRIMARY KEY (id)`
- **æ™®é€šç´¢å¼•**ï¼š`KEY novel_id (novel_id)`
- **æ™®é€šç´¢å¼•**ï¼š`KEY volume_id (volume_id)`
- **å”¯ä¸€çº¦æŸ**ï¼š**æœªå‘ç° `(novel_id, chapter_number)` çš„å”¯ä¸€ç´¢å¼•**ï¼Œä½†ä»£ç ä¸­æœ‰å”¯ä¸€æ€§æ£€æŸ¥é€»è¾‘

**å¤šè¯­è¨€/ç¿»è¯‘ç›¸å…³å­—æ®µ**ï¼š
- âŒ **æ²¡æœ‰ `content_en`ã€`title_en` ç­‰ç¿»è¯‘å­—æ®µ**
- âŒ **æ²¡æœ‰ `language` å­—æ®µ**
- âŒ **æ²¡æœ‰ `is_translated` å­—æ®µ**

### 3.2 `novel` è¡¨ç»“æ„åŠä¸ç« èŠ‚å…³ç³»

**å®Œæ•´ CREATE TABLE è¯­å¥**ï¼ˆå…³é”®å­—æ®µï¼‰ï¼š

```sql
CREATE TABLE `novel` (
  `id` int NOT NULL AUTO_INCREMENT,
  `user_id` int DEFAULT NULL COMMENT 'ä½œè€…ç”¨æˆ·ID',
  `title` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `status` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `cover` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `rating` int DEFAULT '0',
  `reviews` int DEFAULT '0',
  `author` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `translator` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `description` text COLLATE utf8mb4_unicode_ci,
  `recommendation` text COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `languages` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT 'æ”¯æŒçš„è¯­è¨€ï¼ˆå¦‚ï¼šen,zh,esï¼Œå¤šä¸ªè¯­è¨€ç”¨é€—å·åˆ†éš”ï¼‰',
  `chapters` int DEFAULT '0',
  `licensed_from` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `review_status` enum('created','submitted','reviewing','approved','published','unlisted','archived','locked') DEFAULT 'created',
  `champion_status` enum('submitted','invalid','approved','rejected') DEFAULT 'invalid' COMMENT 'Championä¼šå‘˜ç³»ç»ŸçŠ¶æ€',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_review_status` (`review_status`),
  CONSTRAINT `novel_ibfk_user` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

**ä¸ç« èŠ‚çš„å…³è”**ï¼š
- `novel.id` â† `chapter.novel_id`ï¼ˆå¤–é”®ï¼‰
- `novel.user_id`ï¼šä½œè€…ç”¨æˆ·IDï¼Œç”¨äºæŸ¥è¯¢ä½œè€…ä¿¡æ¯å’Œæƒé™éªŒè¯

**å¤šè¯­è¨€ç›¸å…³å­—æ®µ**ï¼š
- âœ… `languages`ï¼šæ”¯æŒçš„è¯­è¨€åˆ—è¡¨ï¼ˆé€—å·åˆ†éš”ï¼Œå¦‚ `'en,zh,es'`ï¼‰
- âŒ **æ²¡æœ‰ä¸“é—¨çš„ç¿»è¯‘è¡¨å…³è”**

### 3.3 æ˜¯å¦å­˜åœ¨ç¿»è¯‘/å¤šè¯­è¨€ç›¸å…³è¡¨

**æœç´¢ç»“æœ**ï¼š

1. **`languages` è¡¨**ï¼ˆå­˜åœ¨ï¼‰ï¼š
   ```sql
   CREATE TABLE `languages` (
     `id` int NOT NULL AUTO_INCREMENT COMMENT 'è¯­è¨€ID',
     `language` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT 'è¯­è¨€åç§°',
     `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
     PRIMARY KEY (`id`),
     UNIQUE KEY `unique_language` (`language`)
   ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='è¯­è¨€è¡¨';
   ```
   - **ç”¨é€”**ï¼šå­˜å‚¨æ”¯æŒçš„è¯­è¨€åˆ—è¡¨ï¼ˆå¦‚ 'English', 'Chinese', 'Spanish'ï¼‰
   - **å…³è”å…³ç³»**ï¼š**æœªå‘ç°ä¸ `chapter` æˆ– `novel` è¡¨çš„ç›´æ¥å…³è”**

2. **ç¿»è¯‘ç›¸å…³è¡¨**ï¼š
   - âŒ **æ²¡æœ‰ `chapter_translation` è¡¨**
   - âŒ **æ²¡æœ‰ `chapter_translated` è¡¨**
   - âŒ **æ²¡æœ‰ `chapter_en` è¡¨**
   - âŒ **æ²¡æœ‰ `translation` è¡¨**
   - âŒ **æ²¡æœ‰ `chapter_lang` è¡¨**

**ç»“è®º**ï¼š
- âœ… å­˜åœ¨ `languages` è¡¨ï¼ˆè¯­è¨€åˆ—è¡¨ï¼‰
- âŒ **ç›®å‰æ²¡æœ‰ä¸“é—¨å­˜å‚¨ç« èŠ‚ç¿»è¯‘å†…å®¹çš„è¡¨**
- âŒ **ç›®å‰æ²¡æœ‰ç« èŠ‚ä¸ç¿»è¯‘çš„å…³è”è¡¨**

### 3.4 ä¸ç« èŠ‚åˆ›å»ºè”åŠ¨çš„å…¶å®ƒè¡¨

#### 3.4.1 `author_daily_word_count` è¡¨

**ç”¨é€”**ï¼šè®°å½•ä½œè€…æ¯æ—¥æ›´æ–°å­—æ•°å˜æ›´

**è¡¨ç»“æ„**ï¼šè§ 2.3.3 èŠ‚

**å†™å…¥æ—¶æœº**ï¼šç« èŠ‚åˆ›å»º/æ›´æ–°æ—¶ï¼Œå¦‚æœ `is_released === 1` ä¸” `release_date` ä¸ä¸ºç©º

**Service**ï¼š`backend/services/authorDailyWordCountService.js`

#### 3.4.2 `scheduledrelease` è¡¨

**ç”¨é€”**ï¼šå­˜å‚¨å®šæ—¶å‘å¸ƒçš„ç« èŠ‚

**å†™å…¥æ—¶æœº**ï¼šç« èŠ‚åˆ›å»º/æ›´æ–°æ—¶ï¼Œå¦‚æœ `release_date` å­˜åœ¨ä¸” `is_released === 0`

**å­—æ®µ**ï¼ˆæ¨æµ‹ï¼‰ï¼š
- `novel_id`
- `chapter_id`
- `release_time`
- `is_released`

#### 3.4.3 `unlockprice` è¡¨

**ç”¨é€”**ï¼šå­˜å‚¨å°è¯´çš„è§£é”ä»·æ ¼é…ç½®

**å­—æ®µ**ï¼ˆä»ä»£ç æ¨æ–­ï¼‰ï¼š
- `user_id`
- `novel_id`
- `karma_per_1000`ï¼šæ¯1000å­—å¯¹åº”çš„Karma
- `min_karma`ï¼šæœ€å°Karma
- `max_karma`ï¼šæœ€å¤§Karma
- `default_free_chapters`ï¼šé»˜è®¤å…è´¹ç« èŠ‚æ•°
- `pricing_style`ï¼šè®¡ä»·æ–¹å¼ï¼ˆå¦‚ 'per_word'ï¼‰

**è¯»å–æ—¶æœº**ï¼šåˆ›å»ºç« èŠ‚æ—¶ï¼Œç”¨äºè®¡ç®— `unlock_price`

#### 3.4.4 `novel_champion_tiers` è¡¨

**ç”¨é€”**ï¼šå­˜å‚¨Championä¼šå‘˜ç­‰çº§é…ç½®

**å­—æ®µ**ï¼ˆä»ä»£ç æ¨æ–­ï¼‰ï¼š
- `novel_id`
- `tier_level`ï¼šç­‰çº§
- `advance_chapters`ï¼šé¢„è¯»ç« èŠ‚æ•°
- `is_active`ï¼šæ˜¯å¦æ¿€æ´»

**è¯»å–æ—¶æœº**ï¼šåˆ›å»ºç« èŠ‚æ—¶ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦è®¾ç½®ä¸ºé¢„è¯»ç« èŠ‚

---

## å››ã€ä¸æœªæ¥"AI æ‰¹é‡ç¿»è¯‘å¯¼å…¥"ç›´æ¥ç›¸å…³çš„å‘ç°

### 4.1 ç›®å‰å¯ä»¥å¤ç”¨çš„éƒ¨åˆ†

1. **ç« èŠ‚åˆ›å»º Service**ï¼š
   - âœ… `POST /api/chapter/create` æ¥å£å¯ä»¥å¤ç”¨
   - âœ… ç« èŠ‚åˆ›å»ºçš„æ ¸å¿ƒé€»è¾‘ï¼ˆæ ¡éªŒã€çŠ¶æ€è®¾ç½®ã€ä»·æ ¼è®¡ç®—ï¼‰å¯ä»¥å¤ç”¨
   - âœ… å­—æ•°ç»Ÿè®¡é€»è¾‘å¯ä»¥å¤ç”¨

2. **æ‰¹é‡ä¸Šä¼ é€»è¾‘**ï¼š
   - âœ… `backend/upload_novel.js` ä¸­çš„ `uploadChapters()` å‡½æ•°å¯ä»¥ä½œä¸ºå‚è€ƒ
   - âš ï¸ ä½†éœ€è¦æ³¨æ„ï¼šè¯¥å‡½æ•°ä¸åŒ…å«å®Œæ•´çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚å®¡æ ¸çŠ¶æ€ã€å­—æ•°ç»Ÿè®¡ç­‰ï¼‰

3. **æ•°æ®åº“å­—æ®µ**ï¼š
   - âœ… `chapter.content` å­—æ®µå¯ä»¥å­˜å‚¨ç¿»è¯‘åçš„æ­£æ–‡
   - âœ… `chapter.title` å­—æ®µå¯ä»¥å­˜å‚¨ç¿»è¯‘åçš„æ ‡é¢˜
   - âœ… `chapter.translator_note` å­—æ®µå¯ä»¥å­˜å‚¨ç¿»è¯‘ç›¸å…³å¤‡æ³¨

4. **å¯¼èˆªç»“æ„**ï¼š
   - âœ… `adminMenuConfig.ts` çš„é…ç½®æ–¹å¼å¯ä»¥å¤ç”¨
   - âœ… å¯ä»¥åœ¨ `incomeEditorMenuGroup.items` ä¸­æ–°å¢èœå•é¡¹

### 4.2 ç›®å‰ç¼ºå¤±çš„éƒ¨åˆ†

1. **ç¿»è¯‘è¡¨ç»“æ„**ï¼š
   - âŒ **æ²¡æœ‰ä¸“é—¨çš„ç¿»è¯‘è¡¨**ï¼ˆå¦‚ `chapter_translation`ï¼‰
   - âŒ **æ²¡æœ‰åŸæ–‡æœ¬ä¸ç¿»è¯‘æ–‡æœ¬çš„å…³è”è¡¨**
   - âŒ **æ²¡æœ‰ç¿»è¯‘ä»»åŠ¡/æ‰¹æ¬¡è¡¨**ï¼ˆç”¨äºè®°å½•æ‰¹é‡ç¿»è¯‘ä»»åŠ¡çš„çŠ¶æ€ï¼‰

2. **ç¿»è¯‘ç›¸å…³å­—æ®µ**ï¼š
   - âŒ `chapter` è¡¨ä¸­æ²¡æœ‰ `source_language` å­—æ®µ
   - âŒ `chapter` è¡¨ä¸­æ²¡æœ‰ `target_language` å­—æ®µ
   - âŒ `chapter` è¡¨ä¸­æ²¡æœ‰ `translation_status` å­—æ®µ
   - âŒ `chapter` è¡¨ä¸­æ²¡æœ‰ `original_content` å­—æ®µï¼ˆå¦‚æœç¿»è¯‘åè¦†ç›–åŸå†…å®¹ï¼‰

3. **æ‰¹é‡å¯¼å…¥åŠŸèƒ½**ï¼š
   - âŒ **æ²¡æœ‰æ‰¹é‡å¯¼å…¥ç« èŠ‚çš„ä¸“é—¨æ¥å£**ï¼ˆ`upload_novel.js` ä¸­çš„é€»è¾‘ä¸å®Œæ•´ï¼‰
   - âŒ **æ²¡æœ‰å¯¼å…¥ä»»åŠ¡ç®¡ç†åŠŸèƒ½**ï¼ˆä»»åŠ¡çŠ¶æ€ã€è¿›åº¦ã€é”™è¯¯æ—¥å¿—ç­‰ï¼‰

4. **AI ç¿»è¯‘ç›¸å…³**ï¼š
   - âŒ **æ²¡æœ‰ AI ç¿»è¯‘æœåŠ¡é›†æˆ**
   - âŒ **æ²¡æœ‰ç¿»è¯‘é…ç½®è¡¨**ï¼ˆAPI Keyã€æ¨¡å‹é€‰æ‹©ã€ç¿»è¯‘å‚æ•°ç­‰ï¼‰

### 4.3 éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ä¸šåŠ¡è§„åˆ™

1. **ç« èŠ‚å·å”¯ä¸€æ€§**ï¼š
   - âš ï¸ **åŒä¸€å°è¯´å†…ï¼Œ`chapter_number` å¿…é¡»å”¯ä¸€**
   - âš ï¸ åˆ›å»ºç« èŠ‚å‰å¿…é¡»æ£€æŸ¥æ˜¯å¦å­˜åœ¨ç›¸åŒ `chapter_number` çš„ç« èŠ‚
   - âš ï¸ æ‰¹é‡å¯¼å…¥æ—¶ï¼Œéœ€è¦å¤„ç†ç« èŠ‚å·å†²çªï¼ˆè·³è¿‡ã€è¦†ç›–ã€æˆ–è‡ªåŠ¨é€’å¢ï¼‰

2. **å®¡æ ¸çŠ¶æ€**ï¼š
   - âš ï¸ æ–°åˆ›å»ºçš„ç« èŠ‚é»˜è®¤ `review_status = 'submitted'`ï¼ˆè¿›å…¥å®¡æ ¸æµç¨‹ï¼‰
   - âš ï¸ åªæœ‰ `review_status = 'approved'` ä¸” `is_released = 1` çš„ç« èŠ‚æ‰ä¼šè¢«è¯»è€…çœ‹åˆ°
   - âš ï¸ æ‰¹é‡å¯¼å…¥çš„ç« èŠ‚å¯èƒ½éœ€è¦æ‰¹é‡å®¡æ ¸åŠŸèƒ½

3. **å­—æ•°ç»Ÿè®¡**ï¼š
   - âš ï¸ åªæœ‰ `is_released = 1` ä¸” `release_date` ä¸ä¸ºç©ºæ—¶ï¼Œæ‰ä¼šè®°å½•åˆ° `author_daily_word_count`
   - âš ï¸ æ‰¹é‡å¯¼å…¥æ—¶ï¼Œå¦‚æœç« èŠ‚æœªå‘å¸ƒï¼Œä¸ä¼šè§¦å‘å­—æ•°ç»Ÿè®¡

4. **è§£é”ä»·æ ¼è®¡ç®—**ï¼š
   - âš ï¸ è§£é”ä»·æ ¼ä¾èµ–äº `unlockprice` è¡¨çš„é…ç½®
   - âš ï¸ å…è´¹ç« èŠ‚æ•°ç”± `default_free_chapters` å†³å®š
   - âš ï¸ æ‰¹é‡å¯¼å…¥æ—¶ï¼Œéœ€è¦ç¡®ä¿ `unlockprice` é…ç½®å·²å­˜åœ¨

5. **é¢„è¯»ç« èŠ‚é€»è¾‘**ï¼š
   - âš ï¸ åªæœ‰æ”¶è´¹ç« èŠ‚æ‰å¯èƒ½æˆä¸ºé¢„è¯»ç« èŠ‚
   - âš ï¸ é¢„è¯»ç« èŠ‚æ•°é‡å— `novel_champion_tiers.advance_chapters` é™åˆ¶
   - âš ï¸ æ‰¹é‡å¯¼å…¥æ—¶ï¼Œéœ€è¦æ­£ç¡®è®¾ç½® `is_advance` å­—æ®µ

6. **å·ï¼ˆVolumeï¼‰å…³è”**ï¼š
   - âš ï¸ æ¯ä¸ªç« èŠ‚å¿…é¡»å…³è”ä¸€ä¸ª `volume_id`
   - âš ï¸ æ‰¹é‡å¯¼å…¥æ—¶ï¼Œéœ€è¦ç¡®ä¿å·å·²åˆ›å»ºï¼Œæˆ–ä½¿ç”¨é»˜è®¤å·

---

## äº”ã€æ€»ç»“ä¸å»ºè®®

### 5.1 å®ç°"AI æ‰¹é‡ç¿»è¯‘å¯¼å…¥"åŠŸèƒ½éœ€è¦çš„å·¥ä½œ

1. **æ•°æ®åº“è®¾è®¡**ï¼š
   - åˆ›å»ºç¿»è¯‘è¡¨ï¼ˆå¦‚ `chapter_translation`ï¼‰æˆ–æ‰©å±• `chapter` è¡¨
   - åˆ›å»ºç¿»è¯‘ä»»åŠ¡è¡¨ï¼ˆå¦‚ `translation_task`ï¼‰
   - åˆ›å»ºç¿»è¯‘é…ç½®è¡¨ï¼ˆå¦‚ `translation_config`ï¼‰

2. **åç«¯æ¥å£å¼€å‘**ï¼š
   - åˆ›å»ºæ‰¹é‡å¯¼å…¥ç¿»è¯‘ç« èŠ‚çš„æ¥å£
   - é›†æˆ AI ç¿»è¯‘æœåŠ¡ï¼ˆå¦‚ OpenAIã€Google Translate ç­‰ï¼‰
   - å®ç°ç¿»è¯‘ä»»åŠ¡ç®¡ç†ï¼ˆåˆ›å»ºã€æŸ¥è¯¢ã€å–æ¶ˆã€é‡è¯•ç­‰ï¼‰

3. **å‰ç«¯é¡µé¢å¼€å‘**ï¼š
   - åœ¨ AdminPanel ä¸­æ–°å¢"AI æ‰¹é‡ç¿»è¯‘å¯¼å…¥"é¡µé¢
   - å®ç°æ–‡ä»¶ä¸Šä¼ ã€ä»»åŠ¡åˆ—è¡¨ã€è¿›åº¦å±•ç¤ºç­‰åŠŸèƒ½

4. **ä¸šåŠ¡é€»è¾‘å®Œå–„**ï¼š
   - å¤ç”¨ç°æœ‰çš„ç« èŠ‚åˆ›å»ºé€»è¾‘
   - å¤„ç†ç« èŠ‚å·å†²çª
   - å¤„ç†å®¡æ ¸çŠ¶æ€
   - å¤„ç†å­—æ•°ç»Ÿè®¡

### 5.2 å…³é”®æ–‡ä»¶è·¯å¾„æ±‡æ€»

**å‰ç«¯**ï¼š
- `frontend/src/pages/AdminPanel.tsx` - ä¸»é¡µé¢
- `frontend/src/pages/adminMenuConfig.ts` - èœå•é…ç½®
- `frontend/src/pages/AdminPanel/ChapterApproval/` - ç« èŠ‚å®¡æ‰¹é¡µé¢ï¼ˆå¯å‚è€ƒï¼‰

**åç«¯**ï¼š
- `backend/routes/novelCreation.js` - ç« èŠ‚åˆ›å»º/æ›´æ–°æ¥å£
- `backend/upload_novel.js` - æ‰¹é‡ä¸Šä¼ é€»è¾‘ï¼ˆå¯å‚è€ƒï¼‰
- `backend/services/authorDailyWordCountService.js` - å­—æ•°ç»Ÿè®¡æœåŠ¡

**æ•°æ®åº“**ï¼š
- `backend/database_schema.sql` - æ•°æ®åº“è¡¨ç»“æ„
- `backend/database_schema.md` - æ•°æ®åº“è¡¨è¯´æ˜

---

**æŠ¥å‘Šå®Œæˆæ—¶é—´**ï¼š2025-12-07  
**æŠ¥å‘Šç‰ˆæœ¬**ï¼šv1.0

